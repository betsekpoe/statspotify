<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>StatSpotify ‚Äî Your Spotify stats</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Loading Spinner -->
  <div class="loading-overlay" id="loading-overlay">
    <div class="spinner"></div>
    <div class="loading-text">Loading your stats...</div>
  </div>

  <div class="app">
    <aside class="sidebar">
      <div class="brand" id="brand-btn">StatSpotify</div>
      <nav class="nav">
        <button class="nav-item" data-view="top-tracks">Top Tracks</button>
        <button class="nav-item" data-view="top-artists">Top Artists</button>
        <button class="nav-item" data-view="recently-played">Recently Played</button>
        <button class="nav-item" data-view="charts">Charts</button>
        <!-- <button class="nav-item" data-view="playlists">Playlists</button> -->
      </nav>
      <div class="sidebar-bottom">
        <button id="refresh-btn" class="btn" style="display:none">
          <span>üîÑ</span> Refresh Data
        </button>
        <button id="login-btn" class="btn primary">Connect Spotify</button>
        <button id="logout-btn" class="btn" style="display:none">Sign out</button>
      </div>
    </aside>

    <div class="content">
      <header class="topbar">
        <div class="search">
          <input id="search-input" placeholder="Search tracks, artists..." />
        </div>
        <div class="profile-container">
          <div class="profile" id="profile-area">
            <!-- profile inserted here -->
          </div>
          <!-- Mobile profile dropdown -->
          <div class="profile-dropdown" id="profile-dropdown" style="display:none">
            <!-- <button class="profile-dropdown-item" id="mobile-refresh-btn">
              Refresh Data
            </button> -->
            <button class="profile-dropdown-item" id="mobile-logout-btn">
              Sign Out
            </button>
          </div>
        </div>
      </header>

      

      <main class="main">
        <!-- Home View -->
        <section class="view-section active" id="view-home">
          <section class="hero" id="hero-section">
            <h1>Your Spotify stats, beautifully visualized</h1>
            <p>Connect with Spotify to view your top tracks, artists and listening insights.</p>
          </section>

          <!-- Mobile login button (shown when not logged in) -->
      <div class="mobile-login" id="mobile-login-btn">
        <button class="btn primary">Connect Spotify</button>
      </div>

          <section class="cards" id="cards">
            <!-- dynamic cards: top tracks / artists / albums -->
          </section>

          <section class="list-section">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
              <h2 id="home-tracks-heading" style="margin:0">Recent Top Tracks</h2>
              <span id="last-updated" style="font-size:12px;color:#b3b3b3"></span>
            </div>
            <div id="home-top-tracks" class="track-list">
              <!-- track rows populated here -->
            </div>
          </section>
        </section>

        <!-- Top Tracks View -->
        <section class="view-section" id="view-top-tracks">
          <h1>Top Tracks</h1>
          <p class="view-subtitle">üìä Note: Spotify updates this data every few days. Use "Recently Played" for real-time listening.</p>
          <div id="top-tracks" class="track-list">
            <!-- track rows populated here -->
          </div>
        </section>

        <!-- Top Artists View -->
        <section class="view-section" id="view-top-artists">
          <h1>Top Artists</h1>
          <p class="view-subtitle">üìä Note: Spotify updates this data every few days. Use "Recently Played" for real-time listening.</p>
          <div id="top-artists" class="artist-grid">
            <!-- artist cards populated here -->
          </div>
        </section>

        <!-- Playlists View -->
        <section class="view-section" id="view-playlists">
          <h1>Your Playlists</h1>
          <div id="playlists" class="playlist-grid">
            <!-- playlist cards populated here -->
          </div>
        </section>

        <!-- Recently Played View -->
        <section class="view-section" id="view-recently-played">
          <h1>Recently Played</h1>
          <p class="view-subtitle">Your last 50 played tracks (real-time data)</p>
          <div id="recently-played-tracks" class="track-list">
            <!-- track rows populated here -->
          </div>
        </section>

        <!-- Charts View -->
        <section class="view-section" id="view-charts">
          <h1>Listening Charts</h1>
          <p class="view-subtitle">Track your listening patterns over time</p>
          
          <div class="chart-container">
            <div class="chart-header">
              <h2 id="chart-title">Top Tracks Over Time</h2>
              <div class="chart-controls">
                <button class="chart-period-btn active" data-period="week">Week</button>
                <button class="chart-period-btn" data-period="month">Month</button>
                <button class="chart-period-btn" data-period="6months">6 Months</button>
                <button class="chart-period-btn" data-period="year">Year</button>
              </div>
            </div>
            <canvas id="listening-chart" width="800" height="300"></canvas>
          </div>

          <div class="chart-insights">
            <h3>Your Top Tracks</h3>
            <div id="chart-top-items" class="chart-items-list">
              <!-- populated dynamically -->
            </div>
          </div>
        </section>

        <!-- Track Details View -->
        <section class="view-section" id="view-track-details">
          <button class="back-btn" id="back-from-track">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
              <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
            </svg>
            Back
          </button>
          
          <div class="track-details-container">
            <div class="track-header">
              <img id="track-detail-image" src="" alt="Album art" class="track-detail-album-art">
              <div class="track-header-info">
                <h1 id="track-detail-name">Track Name</h1>
                <p id="track-detail-artist" class="track-detail-artist">Artist Name</p>
                <p id="track-detail-album" class="track-detail-album">Album Name</p>
                <div class="track-basic-info">
                  <span id="track-detail-duration">0:00</span>
                  <span class="divider">‚Ä¢</span>
                  <span id="track-detail-release">2024</span>
                </div>
              </div>
            </div>

            <!-- Popularity Score - The Hook -->
            <div class="stat-card popularity-card">
              <div class="stat-header">
                <h3>Popularity</h3>
                <div class="stat-value-large" id="track-popularity">--</div>
              </div>
              <div class="popularity-bar">
                <div class="popularity-fill" id="popularity-fill"></div>
              </div>
              <p class="stat-description" id="popularity-description">Loading...</p>
            </div>

            <!-- Mood Quadrant -->
            <div class="stat-card mood-card">
              <h3>Mood & Energy</h3>
              <div class="mood-quadrant">
                <canvas id="mood-chart" width="300" height="300"></canvas>
                <div class="mood-labels">
                  <span class="mood-label top">Energetic</span>
                  <span class="mood-label bottom">Calm</span>
                  <span class="mood-label left">Sad</span>
                  <span class="mood-label right">Happy</span>
                </div>
              </div>
              <p class="mood-classification" id="mood-classification">Loading...</p>
            </div>

            <!-- Audio Features Grid -->
            <div class="audio-features-grid">
              <div class="feature-card">
                <div class="feature-icon">üéµ</div>
                <div class="feature-label">Tempo</div>
                <div class="feature-value" id="track-tempo">-- BPM</div>
                <div class="feature-bar">
                  <div class="feature-fill" id="tempo-fill"></div>
                </div>
              </div>

              <div class="feature-card">
                <div class="feature-icon">üéπ</div>
                <div class="feature-label">Key</div>
                <div class="feature-value" id="track-key">--</div>
                <div class="feature-description" id="track-mode">--</div>
              </div>

              <div class="feature-card">
                <div class="feature-icon">üíÉ</div>
                <div class="feature-label">Danceability</div>
                <div class="feature-value" id="track-danceability">--%</div>
                <div class="feature-bar">
                  <div class="feature-fill" id="danceability-fill"></div>
                </div>
              </div>

              <div class="feature-card">
                <div class="feature-icon">‚ö°</div>
                <div class="feature-label">Energy</div>
                <div class="feature-value" id="track-energy">--%</div>
                <div class="feature-bar">
                  <div class="feature-fill" id="energy-fill"></div>
                </div>
              </div>

              <div class="feature-card">
                <div class="feature-icon">üòä</div>
                <div class="feature-label">Valence</div>
                <div class="feature-value" id="track-valence">--%</div>
                <div class="feature-bar">
                  <div class="feature-fill" id="valence-fill"></div>
                </div>
              </div>

              <div class="feature-card">
                <div class="feature-icon">üó£Ô∏è</div>
                <div class="feature-label">Speechiness</div>
                <div class="feature-value" id="track-speechiness">--%</div>
                <div class="feature-bar">
                  <div class="feature-fill" id="speechiness-fill"></div>
                </div>
              </div>

              <div class="feature-card">
                <div class="feature-icon">üé∏</div>
                <div class="feature-label">Acousticness</div>
                <div class="feature-value" id="track-acousticness">--%</div>
                <div class="feature-bar">
                  <div class="feature-fill" id="acousticness-fill"></div>
                </div>
              </div>

              <div class="feature-card">
                <div class="feature-icon">üé§</div>
                <div class="feature-label">Liveness</div>
                <div class="feature-value" id="track-liveness">--%</div>
                <div class="feature-bar">
                  <div class="feature-fill" id="liveness-fill"></div>
                </div>
              </div>
            </div>

            <!-- Fun Insights -->
            <div class="stat-card insights-card">
              <h3>Track Insights</h3>
              <div class="insights-list" id="track-insights">
                <!-- Dynamic insights populated here -->
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>

    <!-- Mobile Bottom Nav -->
    <nav class="mobile-nav">
      <button class="mobile-nav-item" data-view="home" title="Home">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12.5 3.247a1 1 0 0 0-1 0L4 7.577V20h4.5v-6a1 1 0 0 1 1-1h5a1 1 0 0 1 1 1v6H20V7.577l-7.5-4.33zm-2-1.732a3 3 0 0 1 3 0l7.5 4.33a2 2 0 0 1 1 1.732V21a1 1 0 0 1-1 1h-6.5a1 1 0 0 1-1-1v-6h-3v6a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7.577a2 2 0 0 1 1-1.732l7.5-4.33z"/></svg>
        <span>Home</span>
      </button>
      <button class="mobile-nav-item" data-view="top-tracks" title="Top Tracks">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M6 3h2v18H6V3zm3 9h2v9H9v-9zm3-4h2v13h-2V8zm3-4h2v17h-2V4z"/></svg>
        <span>Tracks</span>
      </button>
      <button class="mobile-nav-item" data-view="top-artists" title="Top Artists">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/></svg>
        <span>Artists</span>
      </button>
      <button class="mobile-nav-item" data-view="recently-played" title="Recently Played">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M13 3v9.28c-.47-.17-.97-.28-1.5-.28-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6.5z"/></svg>
        <span>Recent</span>
      </button>
      <button class="mobile-nav-item" data-view="charts" title="Charts">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M3.5 18.49l6-6.01 4 4L22 6.92l-1.41-1.41-7.09 7.97-4-4L2 16.99z"/></svg>
        <span>Charts</span>
      </button>
      <!-- <button class="mobile-nav-item" data-view="playlists" title="Playlists">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M15 6H3v2h12V6zm0 4H3v2h12v-2zM3 16h8v-2H3v2zM17 6v8.18c-.31-.11-.65-.18-1-.18-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3V8h3V6h-5z"/></svg>
        <span>Playlists</span>
      </button> -->
    </nav>
  </div>

  <script src="app.js" type="module"></script>
</body>
</html>
